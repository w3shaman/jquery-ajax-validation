/**
 * jQuery Plugin for adding server validation feature to Ajax Form plugin
 * @version 1.1
 * @requires jQuery 1.4 or later and jQuery Form Plugin (http://malsup.com/jquery/form/)
 *
 * Copyright (c) 2016 Lucky <bogeyman2007@gmail.com>
 * Licensed under the GPL license:
 *   http://www.gnu.org/licenses/gpl.html
 */

(function(c){function a(g){c("#"+g).css({display:"block",position:"absolute",top:c(document).scrollTop()+"px",left:((c(window).width()-c("#"+g).width())/2)+c(document).scrollLeft()+"px",opacity:0.8})}function d(g,h){c("#"+g).html(h);a(g);c(window).scroll(function(){a(g)})}function b(g){c("#"+g).hide();c(window).scroll(function(){c("#"+g).hide()})}function e(h,g){c("#"+h).html(g);c("#"+h).fadeIn("fast",function(){f(h)})}function f(g){clearTimeout(c.fn.ajaxvalidation.messageTimeOut);c.fn.ajaxvalidation.messageTimeOut=setTimeout('$("#'+g+'").fadeOut("fast")',10000)}c.fn.ajaxvalidation=function(h){var g={messageDivId:"message",waitingDivId:"waiting",loadingMessage:"Loading...",errorChar:"*",onComplete:null,onError:null,selector:"name"};c.extend(g,h);if(g.waitingDivId!=null&&g.waitingDivId!=""){c("body").append('<div id="'+g.waitingDivId+'"></div>');b(g.waitingDivId)}this.each(function(){var i=c(this);i.submit(function(){d(g.waitingDivId,g.loadingMessage)});i.ajaxForm({success:function(m){b(g.waitingDivId);try{var j=null;if(typeof m=="string"){j=c.parseJSON(m)}else{if(typeof m=="object"){j=m}}if(j!=null){if(j.clearForm==true){i.clearForm()}var k=c("input:file");if(typeof k.MultiFile==="function"){if(k.length>0){k.MultiFile("reset")}}c(".error-field-char").remove();c("input, select, textarea").removeClass("error-field-background");if(j.errorFields!=null){for(var l in j.errorFields){errorMessage=g.errorChar.replace("[field-message]",j.errorFields[l]);c("input["+g.selector+"='"+l+"'], select["+g.selector+"='"+l+"'], textarea["+g.selector+"='"+l+"']").after('<span class="error-field-char">'+errorMessage+"</span>");c("input["+g.selector+"='"+l+"'], select["+g.selector+"='"+l+"'], textarea["+g.selector+"='"+l+"']").addClass("error-field-background")}}e(g.messageDivId,'<div class="'+j.status+'">'+j.message+"</div>");if(g.onComplete!=null){g.onComplete.call(this,j)}}}catch(n){e(g.messageDivId,'<div class="failed">Oops... An error has occured!!</div>');if(g.onComplete!=null){g.onComplete.call(j)}}},error:function(m,j,l){var k=c("input:file");if(typeof k.MultiFile==="function"){if(k.length>0){k.MultiFile("reset")}}b(g.waitingDivId);e(g.messageDivId,'<div class="failed">Oops... An error has occured!</div>');if(g.onError!=null){g.onError.call(m)}}})})};c.fn.ajaxvalidation.messageTimeOut})(jQuery);
